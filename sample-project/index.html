<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>My tittle</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="bower_components/firebase/firebase-debug.js"></script>
        <script src="bower_components/firebase-simple-login/firebase-simple-login.js"></script>
    </head>

    <body style="margin:5em;">
        <script>

            function getAuthFirebase(firebaseRef, callback){
                var databaseRef = new Firebase(firebaseRef);

                var auth = new FirebaseSimpleLogin(databaseRef, function(error, user) {
                      if (error) {
                        alert('[FirebaseSimpleLogin][Error: ' + error + ']');
                      } else if (user) {
                        alert('[FirebaseSimpleLogin][Success: Successfully logged in][UserID: ' + user.uid + ', Provider: ' + user.provider + ']');
                      } else {
                       alert('[FirebaseSimpleLogin][Message: User is logged out]');
                      }
                });

                callback(auth);
            }

            function reset(auth, email){
                auth.sendPasswordResetEmail(email.value, function(error) {
                      if (error) {
                        alert('[Error: An error occurred during the reset your password process][' + error + ']');
                      } else {
                        alert('[Success: Password reseted successfully. Check your e-mail to get the new password]');
                      }
                });
            }

            function resetPassword(email){
                if(email.validity.valid) {
                    try{

                        getAuthFirebase('https://voppwishlist.firebaseio.com/', function(auth){
                            reset(auth, email);
                        });

                       // function async(fn, callback){

                       //       setTimeout(function() {
                       //          fn();
                       //          callback();
                       //      }, 0);

                       //  }

                    }catch(e){
                        alert('[Error: ocorreu um erro]');
                    }
                }
            }
        </script>

        <form>
            <h1> Reset Password </h1>
            E-mail: <br>
            <input type="email" name="email" style="width:400px">

            <input type="submit" value="Confirmar" onclick="resetPassword(email)" required>
        </form>
    </body>
</html>
